<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Preschool Video Modeling Widget</title>
  <style>
    :root {
      --blue: #2f80ed;
      --green: #27ae60;
      --orange: #f2994a;
      --purple: #9b51e0;
      --pink: #eb5757;
      --bg: #f6f9ff;
      --card: #ffffff;
      --text: #2d3748;
      --muted: #718096;
      --shadow: 0 12px 24px rgba(26, 32, 44, 0.08);
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: "Nunito", "Segoe UI", system-ui, sans-serif;
      background: var(--bg);
      color: var(--text);
    }

    header {
      padding: 28px 24px 12px;
      text-align: center;
    }

    header h1 {
      margin: 0 0 6px;
      font-size: 28px;
      color: var(--blue);
    }

    header p {
      margin: 0 auto;
      max-width: 720px;
      color: var(--muted);
      font-size: 15px;
      line-height: 1.5;
    }

    main {
      display: grid;
      grid-template-columns: minmax(280px, 1fr) 2fr;
      gap: 24px;
      padding: 16px 24px 32px;
    }

    .card {
      background: var(--card);
      border-radius: 18px;
      padding: 20px;
      box-shadow: var(--shadow);
    }

    .card h2 {
      margin-top: 0;
      font-size: 20px;
      color: var(--purple);
    }

    .upload-area {
      border: 2px dashed #cbd5f0;
      border-radius: 16px;
      padding: 18px;
      text-align: center;
      background: #fdfdff;
    }

    .upload-area input {
      margin-top: 12px;
    }

    .video-stage {
      display: grid;
      gap: 18px;
    }

    video {
      width: 100%;
      border-radius: 16px;
      background: #1f2937;
    }

    .controls {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
    }

    .button {
      flex: 1;
      min-width: 140px;
      padding: 10px 14px;
      border-radius: 999px;
      border: none;
      font-weight: 700;
      cursor: pointer;
      color: #fff;
    }

    .button.primary {
      background: var(--green);
    }

    .button.secondary {
      background: var(--orange);
    }

    .button.tertiary {
      background: var(--blue);
    }

    .button:disabled {
      opacity: 0.4;
      cursor: not-allowed;
    }

    .prompt-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
      gap: 12px;
    }

    .prompt {
      background: #f4f1ff;
      border-radius: 14px;
      padding: 12px;
      text-align: center;
      font-weight: 700;
      color: var(--purple);
      border: 2px solid transparent;
      transition: border 0.2s ease;
      cursor: pointer;
    }

    .prompt.active {
      border-color: var(--purple);
      background: #ede7ff;
    }

    .step-list {
      display: grid;
      gap: 12px;
      max-height: 380px;
      overflow-y: auto;
      padding-right: 6px;
    }

    .step {
      border-radius: 14px;
      background: #fdf8ff;
      border: 1px solid #eee;
      padding: 12px;
      display: grid;
      gap: 8px;
    }

    .step-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .step-title {
      font-weight: 700;
      color: var(--blue);
    }

    .step-time {
      font-size: 12px;
      color: var(--muted);
    }

    .step textarea {
      border-radius: 10px;
      border: 1px solid #e2e8f0;
      padding: 8px;
      font-family: inherit;
      resize: vertical;
      min-height: 56px;
    }

    .callout {
      background: #fff3e6;
      border-radius: 16px;
      padding: 16px;
      font-size: 14px;
      color: #6b4b1f;
      border: 1px solid #fbd38d;
      line-height: 1.5;
    }

    .timer {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      background: #edf7ff;
      padding: 12px 16px;
      border-radius: 14px;
    }

    .timer-display {
      font-size: 24px;
      font-weight: 800;
      color: var(--blue);
    }

    .timer-controls {
      display: flex;
      gap: 8px;
    }

    .timer-controls button {
      border-radius: 10px;
      border: none;
      padding: 6px 10px;
      font-weight: 700;
      color: #fff;
      background: var(--blue);
      cursor: pointer;
    }

    footer {
      text-align: center;
      padding-bottom: 24px;
      color: var(--muted);
      font-size: 13px;
    }

    @media (max-width: 900px) {
      main {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <header>
    <h1>üåü Preschool Video Modeling Widget</h1>
    <p>Upload a short classroom routine video, build step-by-step cues, and play it back with child-friendly prompts. This widget supports modeling, practice, and praise in a calm, predictable routine.</p>
  </header>

  <main>
    <section class="card">
      <h2>1) Upload & Plan</h2>
      <div class="upload-area">
        <strong>Upload a routine video</strong>
        <p class="muted">Pick a short clip (1-3 minutes) of the routine you want to model.</p>
        <input id="videoUpload" type="file" accept="video/*" />
      </div>

      <div style="margin-top: 18px;" class="callout">
        <strong>Teaching tip:</strong> Narrate with simple, positive words. Example: ‚ÄúHands wash. Soap. Rinse. Dry.‚Äù Use the same language you want the child to repeat.
      </div>

      <h2 style="margin-top: 20px;">2) Choose a prompt</h2>
      <div class="prompt-grid" id="promptGrid">
        <div class="prompt" data-prompt="Watch">üëÄ Watch</div>
        <div class="prompt" data-prompt="Copy">ü§ù Copy</div>
        <div class="prompt" data-prompt="Try">‚ú® Try</div>
        <div class="prompt" data-prompt="Pause">‚è∏Ô∏è Pause & Practice</div>
        <div class="prompt" data-prompt="Cheer">üéâ Cheer</div>
        <div class="prompt" data-prompt="Next Step">‚û°Ô∏è Next Step</div>
      </div>

      <h2 style="margin-top: 20px;">3) Practice timer</h2>
      <div class="timer">
        <div>
          <div class="timer-display" id="timerDisplay">01:00</div>
          <div style="font-size: 12px; color: var(--muted);">Set a quick practice break.</div>
        </div>
        <div class="timer-controls">
          <button type="button" id="timerMinus">-10s</button>
          <button type="button" id="timerPlus">+10s</button>
          <button type="button" id="timerToggle">Start</button>
        </div>
      </div>
    </section>

    <section class="card video-stage">
      <h2>Video Modeling Workspace</h2>
      <video id="modelVideo" controls></video>

      <div class="controls">
        <button class="button primary" id="addStep" disabled>‚ûï Add Step Marker</button>
        <button class="button secondary" id="playStep" disabled>‚ñ∂Ô∏è Play Selected Step</button>
        <button class="button tertiary" id="resetSteps" disabled>üßπ Reset Steps</button>
      </div>

      <div class="step-list" id="stepList">
        <div class="callout">Add step markers while the video plays. Each step can include a short teaching cue or praise line.</div>
      </div>
    </section>
  </main>

  <footer>
    Designed for preschool classrooms ‚Ä¢ Keep videos short, simple, and positive ‚ù§Ô∏è
  </footer>

  <script>
    const videoUpload = document.getElementById('videoUpload');
    const modelVideo = document.getElementById('modelVideo');
    const addStep = document.getElementById('addStep');
    const playStep = document.getElementById('playStep');
    const resetSteps = document.getElementById('resetSteps');
    const stepList = document.getElementById('stepList');
    const promptGrid = document.getElementById('promptGrid');

    const timerDisplay = document.getElementById('timerDisplay');
    const timerMinus = document.getElementById('timerMinus');
    const timerPlus = document.getElementById('timerPlus');
    const timerToggle = document.getElementById('timerToggle');

    let steps = [];
    let selectedStepIndex = null;
    let activePrompt = null;

    let timerSeconds = 60;
    let timerInterval = null;

    const formatTime = (seconds) => {
      const mins = String(Math.floor(seconds / 60)).padStart(2, '0');
      const secs = String(seconds % 60).padStart(2, '0');
      return `${mins}:${secs}`;
    };

    const updateTimerDisplay = () => {
      timerDisplay.textContent = formatTime(timerSeconds);
    };

    const toggleTimer = () => {
      if (timerInterval) {
        clearInterval(timerInterval);
        timerInterval = null;
        timerToggle.textContent = 'Start';
        return;
      }
      timerToggle.textContent = 'Pause';
      timerInterval = setInterval(() => {
        timerSeconds = Math.max(0, timerSeconds - 1);
        updateTimerDisplay();
        if (timerSeconds === 0) {
          clearInterval(timerInterval);
          timerInterval = null;
          timerToggle.textContent = 'Start';
        }
      }, 1000);
    };

    timerMinus.addEventListener('click', () => {
      timerSeconds = Math.max(10, timerSeconds - 10);
      updateTimerDisplay();
    });

    timerPlus.addEventListener('click', () => {
      timerSeconds = Math.min(300, timerSeconds + 10);
      updateTimerDisplay();
    });

    timerToggle.addEventListener('click', toggleTimer);

    promptGrid.addEventListener('click', (event) => {
      const target = event.target.closest('.prompt');
      if (!target) return;
      promptGrid.querySelectorAll('.prompt').forEach((item) => item.classList.remove('active'));
      target.classList.add('active');
      activePrompt = target.dataset.prompt;
    });

    const renderSteps = () => {
      stepList.innerHTML = '';
      if (steps.length === 0) {
        stepList.innerHTML = '<div class="callout">Add step markers while the video plays. Each step can include a short teaching cue or praise line.</div>';
        playStep.disabled = true;
        resetSteps.disabled = true;
        return;
      }

      steps.forEach((step, index) => {
        const wrapper = document.createElement('div');
        wrapper.className = 'step';
        wrapper.addEventListener('click', () => {
          selectedStepIndex = index;
          highlightSelectedStep();
        });

        const header = document.createElement('div');
        header.className = 'step-header';
        header.innerHTML = `
          <span class="step-title">Step ${index + 1}: ${step.prompt}</span>
          <span class="step-time">${formatTime(Math.floor(step.time))}</span>
        `;

        const textarea = document.createElement('textarea');
        textarea.value = step.note;
        textarea.placeholder = 'Add a short cue or praise line...';
        textarea.addEventListener('input', (event) => {
          steps[index].note = event.target.value;
        });

        wrapper.appendChild(header);
        wrapper.appendChild(textarea);
        stepList.appendChild(wrapper);
      });

      playStep.disabled = selectedStepIndex === null;
      resetSteps.disabled = false;
    };

    const highlightSelectedStep = () => {
      const stepCards = stepList.querySelectorAll('.step');
      stepCards.forEach((card, index) => {
        card.style.borderColor = index === selectedStepIndex ? '#2f80ed' : '#eee';
        card.style.boxShadow = index === selectedStepIndex ? '0 0 0 2px rgba(47,128,237,0.2)' : 'none';
      });
      playStep.disabled = selectedStepIndex === null;
    };

    addStep.addEventListener('click', () => {
      if (!modelVideo.src) return;
      const promptLabel = activePrompt || 'Watch';
      steps.push({
        time: modelVideo.currentTime,
        prompt: promptLabel,
        note: ''
      });
      selectedStepIndex = steps.length - 1;
      renderSteps();
      highlightSelectedStep();
    });

    playStep.addEventListener('click', () => {
      if (selectedStepIndex === null) return;
      modelVideo.currentTime = steps[selectedStepIndex].time;
      modelVideo.play();
    });

    resetSteps.addEventListener('click', () => {
      steps = [];
      selectedStepIndex = null;
      renderSteps();
    });

    videoUpload.addEventListener('change', (event) => {
      const file = event.target.files[0];
      if (!file) return;
      modelVideo.src = URL.createObjectURL(file);
      addStep.disabled = false;
      resetSteps.disabled = false;
      playStep.disabled = true;
      steps = [];
      selectedStepIndex = null;
      renderSteps();
    });

    modelVideo.addEventListener('loadedmetadata', () => {
      modelVideo.currentTime = 0;
    });

    updateTimerDisplay();
  </script>
</body>
</html>
